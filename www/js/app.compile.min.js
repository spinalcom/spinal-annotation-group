(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";angular.module("settings",[]).constant("config",{main_path:"/",spinalhub_url:"127.0.0.1",spinalhub_port:"8888",spinalhub_user:"168"});

},{}],2:[function(require,module,exports){
"use strict";angular.module("app.route",["ngRoute"]),angular.module("app.services",[]),angular.module("app.directives",[]),angular.module("app.controllers",[]),angular.module("app.spinalcom",["settings","ngMaterial"]),angular.module("app.spinalforge.plugin",[]),angular.module("SpinalApp",["ngAnimate","ngMaterial","app.directives","app.route","app.services","app.controllers","ngMdIcons","settings","app.spinalcom","app.spinalforge.plugin","colorpicker.module"]).run(["$rootScope","$location","authService",function(e,a,t){var n=t.get_user();e.$on("$routeChangeStart",function(e,o,r){o.$$route.authenticate&&(t.is_Connected()||t.login(n.username,n.password).then(function(){},function(){a.path("/login")}))})}]).config(["$mdThemingProvider",function(e){e.theme("altTheme").primaryPalette("grey",{default:"200"}).accentPalette("grey",{default:"700"}).dark(),e.theme("default").dark(),e.setDefaultTheme("altTheme"),e.alwaysWatchTheme(!0)}]).run(["$templateCache","$http",function(e,a){for(var t=function(t,n){a.get(t).then(function(a){e.put(n,a.data)},function(e){console.log("Cannot load the file "+t)})},n=[{uri:"app/templates/forgeviewer.html",name:"forgeviewer.html"}],o=0;o<n.length;o++)t(n[o].uri,n[o].name)}]);

},{}],3:[function(require,module,exports){
"use strict";angular.module("app.route").config(["$routeProvider","$locationProvider",function(e,t){e.when("/viewer/:filepath",{templateUrl:"app/templates/main.html",authenticate:!0,controller:"mainCtrl"}).when("/login",{templateUrl:"app/templates/login.html",authenticate:!1,controller:"loginCtrl"}).when("/404",{authenticate:!1,controller:["$location",function(e){e.replace("/drive/")}]}).otherwise({redirectTo:"/404"})}]);

},{}],4:[function(require,module,exports){
"use strict";angular.module("app.spinalforge.plugin").controller("forgeViewerCtrl",["$scope","$rootScope","$mdDialog","authService","$compile","$injector","layout_uid","spinalModelDictionary","spinalRegisterViewerPlugin",function(e,o,t,n,i,r,a,u,c){e.injector=r,e.uid=a.get(),console.log("forgeviewerCtrl start"),o.allNotes=[],o.allNotes=[{title:new Str("test1")},{title:new Str("test1")},{title:new Str("test1")},{title:new Str("test1")}],u.init().then(function(o){var t,n;console.log("forgeviewerCtrl start 2"),c.register("Autodesk.ADN.Viewing.Extension.Color");var i={extensions:c.get()},r={env:"AutodeskProduction",accessToken:""};function onDocumentLoadSuccess(e){0!==(n=t.bubble.search({type:"geometry",role:"3d"})).length?t.selectItem(n[n.length-1].data,onItemLoadSuccess,onItemLoadFail):console.error("Document contains no viewables.")}function onDocumentLoadFailure(e){console.error("onDocumentLoadFailure() - errorCode:"+e)}function onItemLoadSuccess(o,n){o.scope=e,console.log("Viewers are equal: "+(o===t.getCurrentViewer()))}function onItemLoadFail(e){console.error("onItemLoadFail() - errorCode:"+e)}!function(e,o,t){e.oauth.set(""),e.ask_token.set(!0);var n=!0;e.oauth.bind(function oauth_onchange(){n&&""!=e.oauth.get()&&(n=!1,e.oauth.unbind(oauth_onchange),r.accessToken=e.oauth.get(),t(o))})}(o,"urn:"+o.urn.get(),function(o){Autodesk.Viewing.Initializer(r,function(){(t=new Autodesk.Viewing.ViewingApplication("MyViewerDiv"+e.uid)).registerViewer(t.k3D,Autodesk.Viewing.Private.GuiViewer3D,i),t.loadDocument(o,onDocumentLoadSuccess,onDocumentLoadFailure)})})})}]);

},{}],5:[function(require,module,exports){
"use strict";angular.module("app.controllers").controller("loginCtrl",["$scope","authService","$mdToast","$location",function(o,n,t,e){var l=t.simple().hideDelay(3e3);n.get_user();n.logout(),o.conf={email:"",password:""},o.ConnectBtn=function(){n.login(o.conf.email,o.conf.password).then(function(){e.path("/home")},function(o){l.textContent(o),t.show(l)})}}]);

},{}],6:[function(require,module,exports){
"use strict";angular.module("app.controllers").controller("mainCtrl",["$scope","$routeParams","goldenLayoutService","spinalModelDictionary",function(o,r,e,l){e.init()}]);

},{}],7:[function(require,module,exports){
"use strict";angular.module("app.controllers").controller("navbarCtrl",["$scope","authService","$location","$routeParams",function(e,t,o,n){e.username="",e.connected=!1,t.wait_connect().then(function(){e.username=t.get_user().username,e.connected=!0,e.viewer=n.filepath,e.viewer?e.viewer=atob(e.viewer):e.viewer="viewer",console.log(n.filepath)}),e.logout=function(){o.path("/login")},e.layouts=[{id:"drag-viewer",name:"viewer",cfg:{isClosable:!0,title:"viewer",type:"component",componentName:"SpinalHome",componentState:{template:"forgeviewer.html",controller:"forgeViewerCtrl"}}}]}]);

},{}],8:[function(require,module,exports){
"use strict";angular.module("app.directives").directive("navbar",[function(){return{restrict:"E",templateUrl:"app/templates/navbar.html",controller:"navbarCtrl"}}]).directive("menuGlayout",["goldenLayoutService","$timeout",function(t,e){return{restrict:"E",scope:{layoutInfo:"=info"},replace:!0,template:'<li ng-repeat="layout in layoutInfo"  id="{{layout.id}}"><a >{{layout.name}}</a></li>',link:function(e,n,i){t.wait_ready().then(function(){for(var n=function(t,e){return function(){t.createChild(e.cfg)}},i=0;i<e.layoutInfo.length;i++){var r=e.layoutInfo[i];t.createDragSource($("#"+r.id)[0],r.cfg),$("#"+r.id).click(n(t,r))}})}}}]).directive("ngRightClick",["$parse",function(t){return function(e,n,i){var r=t(i.ngRightClick);n.bind("contextmenu",function(t){e.$apply(function(){t.preventDefault(),r(e,{$event:t})})})}}]);

},{}],9:[function(require,module,exports){
(function(e){"use strict";var l=function(){function defineProperties(e,l){for(var i=0;i<l.length;i++){var n=l[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,l,i){return l&&defineProperties(e.prototype,l),i&&defineProperties(e,i),e}}();function _classCallCheck(e,l){if(!(e instanceof l))throw new TypeError("Cannot call a class as a function")}angular.module("app.spinalforge.plugin").run(["$mdDialog","$mdToast","$rootScope","$compile",function(i,n,t,a){e.FilesPanel=function(){function FilesPanel(e,l,i){var n=this;_classCallCheck(this,FilesPanel),this.viewer=e,this.filePanel=null,this.filePanelContent=null,this.model=l,this.user=i,this._file_selected=null,t.execute_func=function(e,l){switch(e){case"delete_file":n.RemoveFile(l);break;case"download_file":n.DownloadFile(l)}}}return l(FilesPanel,[{key:"DownloadFile",value:function(e){for(var l,i=0;i<this._file_selected.files.length;i++)if((l=this._file_selected.files[i])._info.id==e){l.load(function(e,i){if(e instanceof Path){var n=document.createElement("a");n.setAttribute("href","/sceen/_?u="+e._server_id),n.setAttribute("download",l.name),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)}});break}}},{key:"RemoveFile",value:function(e){var l=this,n=i.confirm().ok("Delete !").title("Do you want to remove it?").cancel("Cancel").clickOutsideToClose(!0);i.show(n).then(function(i){for(var n=0;n<l._file_selected.files.length;n++)if(l._file_selected.files[n]._info.id==e){l._file_selected.files.splice(n,1);break}},function(){})}},{key:"handle_files",value:function(e){var l;if(e.length>0)for(var i=0;i<e.length;i++)l=new Path(e[i]),this._file_selected.files.force_add_file(e[i].name,l,{id:newGUID()})}},{key:"DisplayFilePanel",value:function(e,l){var i=this,n=this.model;if(null==this.filePanel){this.filePanel=new PanelClass(this.viewer,l),this.filePanel.initializeMoveHandlers(this.filePanel.container),this.filePanel.container.appendChild(this.filePanel.createCloseButton()),this.filePanel.container.style.right="0px",this.filePanel.container.style.width="400px",this.filePanel.container.style.height="600px",this.filePanel.container.padding="0px",this.filePanelContent=document.createElement("div"),this.filePanelContent.className="file_panel_content";var t=document.createElement("div");t.className="dragDrop";var a=document.createElement("input");a.type="file",a.id="modal-new-dropzone-input",a.setAttribute("multiple","true"),a.className="modal-new-dropzone-input",a.onchange=function(){return i.handle_files(a.files)};var s=document.createElement("label");s.innerHTML='\n                                    <span class="modal-new-span-upload">\n                                        click to Choose files to upload or Drop them here\n                                    </span>\n                                    <ul id="modal-new-list-upload"></ul>',s.className="text-center",s.ondrop=function(e){e.stopPropagation(),e.preventDefault(),i.handle_files(e.dataTransfer.files)},s.ondragover=function(e){e.preventDefault()},s.htmlFor="",t.appendChild(a),t.appendChild(s),this.filePanelContent.appendChild(t);var o=document.createElement("div");o.className="files_div",this.filePanelContent.appendChild(o),this.filePanel.container.appendChild(this.filePanelContent)}this.filePanel.setVisible(!0);for(var d=0;d<n.length;d++)if(n[d].id==e){for(var r=0;r<n[d].listModel.length;r++)if(n[d].listModel[r].id==l){this._file_selected=n[d].listModel[r];break}break}this.filePanel.setTitle(this._file_selected.title.get()),n.bind(function(){i.files_display()})}},{key:"displayItem",value:function(e,l){var i='<md-list-item>\n                        <p class="noteTitle">'+e.name.get()+'</p>\n\n                        <md-button class="i_btn" aria-label="add_item" id='+e._info.id.get()+" ng-click=\"execute_func('delete_file','"+e._info.id.get()+'\')">\n                            <i class="fa fa-trash" aria-hidden="true"></i>\n                        </md-button>\n\n                        <md-button class="i_btn" aria-label="add_item" id='+e._info.id.get()+" ng-click=\"execute_func('download_file','"+e._info.id.get()+'\')">\n                            <i class="fa fa-download" aria-hidden="true"></i>\n                        </md-button>\n                    </md-list-item>',n=angular.element(i);l.append(n),a(n)(t)}},{key:"files_display",value:function(){var e=document.getElementsByClassName("files_div")[0];e.innerHTML="";var l,i=angular.element(e),n=angular.element("<md-list>                </md-list>");i.append(n),a(n)(t);for(var s=0;s<this._file_selected.files.length;s++)l=this._file_selected.files[s],this.displayItem(l,n)}}]),FilesPanel}()}]),e._createClass=l,e._classCallCheck=_classCallCheck}).call(window,window);

},{}],10:[function(require,module,exports){
(function(e){"use strict";var t=function(){function defineProperties(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,a){return t&&defineProperties(e.prototype,t),a&&defineProperties(e,a),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=function(){function MessagePanel(e,t,a){_classCallCheck(this,MessagePanel),this.detailPanel=null,this.detailPanelContent=null,this.model=t,this.viewer=e,this._selected=null,this.user=a}return t(MessagePanel,[{key:"DetailPanel",value:function(e,t){var a=this,n=this.model;console.log("theme id : ",e),console.log("annotation id : ",t),null==this.detailPanelContent&&(this.detailPanelContent=document.createElement("div"),this.detailPanelContent.className="content"),null==this.detailPanel&&(this.detailPanel=new PanelClass(this.viewer,t),this.detailPanel.initializeMoveHandlers(this.detailPanel.container),this.detailPanel.container.appendChild(this.detailPanel.createCloseButton()),this.detailPanel.container.style.right="0px",this.detailPanel.container.style.width="400px",this.detailPanel.container.style.height="600px",this.detailPanel.container.padding="0px");for(var s=0;s<n.length;s++)if(n[s].id==e){for(var l=0;l<n[s].listModel.length;l++)if(n[s].listModel[l].id==t){this._selected=n[s].listModel[l];break}break}var i=document.createElement("div");i.className="form_div";var d=document.createElement("div");d.className="textarea_div";var c=document.createElement("textarea");c.className="form-control",c.setAttribute("rows","2"),c.id=this._selected.id.get(),c.placeholder="add texte",c.onclick=function(){c.focus()},d.appendChild(c);var o=document.createElement("div");o.className="send_button_div";var r=document.createElement("button");r.className="btn btn-block",r.textContent="Add",r.id=this._selected.id.get(),r.onclick=function(){var e=document.querySelector("textarea[id='"+r.id+"']").value;if(document.querySelector("textarea[id='"+r.id+"']").value="",""!=e&&""!=e.trim()){var t=new MessageModel;t.id.set(newGUID()),t.owner.set(a.user.id),t.username.set(a.user.username),t.date.set(Date.now()),t.message.set(e),a._selected.notes.push(t)}},o.appendChild(r),i.appendChild(d),i.appendChild(o),this.detailPanel.setVisible(!0),n.bind(function(){a.DisplayMessage(i)})}},{key:"DisplayMessage",value:function(e){var t=this,a=document.createElement("div");a.className="messageContainer";for(var n=0;n<this._selected.notes.length;n++){var s=document.createElement("div");s.className="message_div";var l=document.createElement("div");l.className="_message";var i=document.createElement("div");i.className="message_owner",i.innerText=this._selected.notes[n].username.get();var d=document.createElement("div");d.className="message_date";var c=new Date(parseInt(this._selected.notes[n].date));d.innerText=c.getDate()+"/"+c.getMonth()+"1/"+c.getFullYear();var o=document.createElement("div");o.className="message_content";var r=document.createElement("div");if(r.className="message_texte",r.innerHTML=this._selected.notes[n].message,this._selected.notes[n].owner==this.user.id){var h=document.createElement("div");h.className="close_div";var m=document.createElement("span");m.innerHTML="X",m.className="close",m.id=this._selected.notes[n].id,m.onclick=function(){t.deteteMessage(this.id,e)},h.appendChild(m),o.appendChild(h)}o.appendChild(r),l.appendChild(i),l.appendChild(o),s.appendChild(d),s.appendChild(l),a.appendChild(s)}this.detailPanelContent.innerHTML="",this.detailPanelContent.appendChild(a),this.detailPanelContent.appendChild(e),this.detailPanel.setTitle(this._selected.title.get()),this.detailPanel.container.appendChild(this.detailPanelContent);var u=document.getElementsByClassName("messageContainer")[0];u.scrollTop=u.scrollHeight}},{key:"deteteMessage",value:function(e,t){for(var a=0;a<this._selected.notes.length;a++)if(this._selected.notes[a].id==e){this._selected.notes.splice(a,1);break}}}]),MessagePanel}();e._createClass=t,e._classCallCheck=_classCallCheck,e.MessagePanel=a}).call(window,window);

},{}],11:[function(require,module,exports){
(function(e){"use strict";var t=function(){function defineProperties(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,o){return t&&defineProperties(e.prototype,t),o&&defineProperties(e,o),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=angular.module("app.spinalforge.plugin");o.run(["$rootScope","$compile","$templateCache","$http","spinalRegisterViewerPlugin",function(e,o,n,l,i){i.register("PannelAnnotation");for(var r=function(e,t){l.get(e).then(function(e){n.put(t,e.data)},function(t){console.log("Cannot load the file "+e)})},a=[{uri:"app/templates/annotationTemplate.html",name:"annotationTemplate.html"},{uri:"app/templates/commentTemplate.html",name:"commentTemplate.html"}],s=0;s<a.length;s++)r(a[s].uri,a[s].name);var c=function(){function PannelAnnotation(e,t){_classCallCheck(this,PannelAnnotation),Autodesk.Viewing.Extension.call(this,e,t),this.viewer=e,this.panel=null}return t(PannelAnnotation,[{key:"load",value:function(){return this.viewer.toolbar?this.createUI():(this.onToolbarCreatedBinded=this.onToolbarCreated.bind(this),this.viewer.addEventListener(av.TOOLBAR_CREATED_EVENT,this.onToolbarCreatedBinded)),!0}},{key:"onToolbarCreated",value:function(){this.viewer.removeEventListener(av.TOOLBAR_CREATED_EVENT,this.onToolbarCreatedBinded),this.onToolbarCreatedBinded=null,this.createUI()}},{key:"unload",value:function(){return this.viewer.toolbar.removeControl(this.subToolbar),!0}},{key:"createUI",value:function(){var e=this;this.panel=new PanelClass(this.viewer,"Annotation");var t=new Autodesk.Viewing.UI.Button("Annotation");t.onClick=function(t){e.panel.isVisible()?e.panel.setVisible(!1):e.panel.setVisible(!0)},t.addClass("fa"),t.addClass("fa-pencil"),t.addClass("fa-2x"),t.setToolTip("Annotation"),this.subToolbar=this.viewer.toolbar.getControl("my-Annotation"),this.subToolbar||(this.subToolbar=new Autodesk.Viewing.UI.ControlGroup("my-Annotation"),this.viewer.toolbar.addControl(this.subToolbar)),this.subToolbar.addControl(t),this.initialize()}},{key:"initialize",value:function(){var t=document.createElement("div");t.style.height="calc(100% - 45px)",t.style.overflowY="auto",this.panel.container.appendChild(t),$(t).html('<div ng-controller="annotationCtrl" ng-cloak>'+n.get("annotationTemplate.html")+"</div>"),o($(t).contents())(e)}}]),PannelAnnotation}();Autodesk.Viewing.theExtensionManager.registerExtension("PannelAnnotation",c)}]).controller("annotationCtrl",["$scope","$rootScope","$mdToast","$mdDialog","authService","$compile","$injector","layout_uid","spinalModelDictionary","$q","messagePanelService","FilePanelService",function(e,t,o,n,l,i,r,a,s,c,d,h){var u=v;e.user=l.get_user(),e.headerBtnClick=function(t){console.log("headerBtnClick"),console.log(t),"add theme"==t.label&&e.addTheme()},e.headerBtn=[{label:"add theme",icon:"note_add"}],e.currentVisibleObj=[],e.themes=[],s.init().then(function(t){t&&(t.groupAnnotationPlugin?t.groupAnnotationPlugin.load(function(t){e.themeListModel=t,e.themeListModel.bind(e.onModelChange)}):(e.themeListModel=new Lst,t.add_attr({groupAnnotationPlugin:new Ptr(e.themeListModel)}),e.themeListModel.bind(e.onModelChange)))}),e.waitObjRdy=function(e){var t,o,n=c.defer();return t=e,o=n,FileSystem._tmp_objects[t._server_id]?setTimeout(function(){deferObjChange(t,o)},200):o.resolve(t),n.promise},e.onModelChange=function(){e.themes=[];for(var t=[],o=0;o<e.themeListModel.length;o++){var n=e.themeListModel[o];t.push(e.waitObjRdy(n))}c.all(t).then(function(t){e.themes=[];for(var o=0;o<e.themeListModel.length;o++){var n=e.themeListModel[o],l=n.get_obj();l._server_id=n._server_id,e.themes.push(l),e.selectedNote&&e.selectedNote._server_id==l._server_id&&(e.selectedNote=l)}})},e.addTheme=function(){n.show(n.prompt().title("Add Theme").placeholder("Please enter the Name").ariaLabel("Add Theme").clickOutsideToClose(!0).required(!0).ok("Confirm").cancel("Cancel")).then(function(t){var o=new ThemeModel;o.name.set(t),o.owner.set(e.user.id),o.username.set(e.user.username),e.themeListModel.push(o)},function(){})},e.$on("colorpicker-closed",function(t,o){console.log(t),console.log(o);for(var n=0;n<e.themes.length;n++)for(var l=e.themes[n],i=0;i<l.listModel.length;i++){var r=l.listModel[i],a=FileSystem._objects[r._server_id];a&&a.color.set(r.color)}}),e.selectedNote=null,e.selectedStyle=function(t){return t.listModel,t===e.selectedNote?"background-color: #4185f4":""},e.getViewIcon=function(e){return e.display?"fa-eye-slash":"fa-eye"},e.selectNote=function(t){e.selectedNote=t},e.renameNote=function(e){n.show(n.prompt().title("Rename").placeholder("Please enter the title").ariaLabel("Rename").clickOutsideToClose(!0).required(!0).ok("Confirm").cancel("Cancel")).then(function(t){var o=FileSystem._objects[e._server_id];console.log(o),o&&(o.title?o.title.set(t):o.name.set(t))},function(){})},e.ViewAllNotes=function(t){t.display?e.restoreColor(t):e.changeItemColor(t)},e.addNoteInTheme=function(t){n.show(n.prompt().title("Add Note").placeholder("Please enter the title").ariaLabel("Add Note").clickOutsideToClose(!0).required(!0).ok("Confirm").cancel("Cancel")).then(function(o){var n=FileSystem._objects[t._server_id],l=new NoteModel;l.title.set(o),l.color.set("#000000"),l.owner.set(e.user.id),l.username.set(e.user.username),n?n.listModel.push(l):console.log("mod null")},function(){console.log("canceled")})},e.deleteNote=function(t){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;console.log(o);var l=n.confirm().ok("Delete !").title("Do you want to remove it?").cancel("Cancel").clickOutsideToClose(!0);n.show(l).then(function(n){if(null!=o)for(var l=0;l<e.themeListModel.length;l++){if((r=e.themeListModel[l])._server_id==t._server_id){for(var i=0;i<r.listModel.length;i++){if(r.listModel[i]._server_id==o._server_id){e.themeListModel[l].listModel.splice(i,1);break}}break}}else for(l=0;l<e.themeListModel.length;l++){var r;if((r=e.themeListModel[l])._server_id==t._server_id){e.themeListModel.splice(l,1);break}}},function(){})},e.addItemInNote=function(e){var t=u.getSelection();0!=t.length?u.model.getBulkProperties(t,{propFilter:["name"]},function(t){var n=FileSystem._objects[e._server_id];if(n){for(var l=0;l<t.length;l++)n.allObject.push(t[l]);var i=o.simple().content("Item added !").action("OK").highlightAction(!0).hideDelay(0).position("bottom right").parent("body");o.show(i)}}):alert("No model selected !")},e.changeItemColor=function(e){var t=[],o=FileSystem._objects[e._server_id];if(o){for(var n=0;n<o.allObject.length;n++)t.push(o.allObject[n]);o.display.set(!0),console.log(o.color),u.setColorMaterial(t,e.color,o._server_id)}},e.restoreColor=function(e){var t=[],o=FileSystem._objects[e._server_id];if(o){for(var n=0;n<o.allObject.length;n++)t.push(o.allObject[n]);o.display.set(!1),u.restoreColorMaterial(t,o._server_id)}},e.commentNote=function(e){d.hideShowPanel(e)},e.sendFile=function(e){h.hideShowPanel(e)}}]),e._createClass=t,e._classCallCheck=_classCallCheck,e.appSpinalforgePlugin=o}).call(window,window);

},{}],12:[function(require,module,exports){
"use strict";angular.module("app.spinalcom").factory("authService",["$q","ngSpinalCore","config","$http",function(e,r,n,t){var o={},a={username:"",password:"",id:""},s=!1;o.save_user=function(e,r,n){a.username=e,a.password=r,a.id=n,window.localStorage.setItem("spinalhome_cfg",btoa(JSON.stringify(a)))},o.get_user=function(){var e=window.localStorage.getItem("spinalhome_cfg");return e&&(a=JSON.parse(atob(e))),a},o.logout=function(e,r){""!=a.username&&(o.save_user("","",""),location.reload())},o.login=function(a,u){var c=e.defer();return t.get("/get_user_id?u="+a+"&p="+u).then(function(e){var t=parseInt(e.data),l=0;if(-1!=t){for(r.connect("http://"+t+":"+u+"@"+n.spinalhub_url+":"+n.spinalhub_port+"/"),o.save_user(a,u,t),s=!0,c.resolve(),l=0;l<i.length;l++)i[l].resolve();i=[]}else{for(c.reject("Login Error: username / password pair not found."),l=0;l<i.length;l++)i[l].reject();i=[]}},function(e){c.reject("Connection Error: Imposible to connect to the server.");for(var r=0;r<i.length;r++)i[r].reject();i=[]}),c.promise},o.is_Connected=function(){return s};var i=[];return o.wait_connect=function(){var r=e.defer();return 1==s?r.resolve():i.push(r),r.promise},o}]);

},{}],13:[function(require,module,exports){
(function(e){"use strict";angular.module("app.spinalcom").factory("FilePanelFactory",["$rootScope","$compile","$templateCache","$http",function(e,t,l,i){for(var n=this,o=function(e,t){i.get(e).then(function(e){l.put(t,e.data)},function(t){console.log("Cannot load the file "+e)})},a=[{uri:"app/templates/fileTemplate.html",name:"fileTemplate.html"}],s=0;s<a.length;s++)o(a[s].uri,a[s].name);this.panel=new PanelClass(v,"message Panel"),this.panel.container.style.right="0px",this.panel.container.style.width="400px",this.panel.container.style.height="600px",this.panel.container.padding="0px";var r=document.createElement("div");r.style.height="calc(100% - 45px)",r.style.overflowY="auto",this.panel.container.appendChild(r);var c=!1;return{getPanel:function(){return 0==c&&(c=!0,$(r).html('<div ng-controller="fileCtrl" class="panelContent" ng-cloak>'+l.get("fileTemplate.html")+"</div>"),t($(r).contents())(e)),n.panel}}}]).factory("FilePanelService",["$rootScope","$compile","$templateCache","$http","FilePanelFactory",function(e,t,l,i,n){var o,a=this,s=!1,r=null;return{hideShowPanel:function(e){0==s&&(s=!0,a.panel=n.getPanel()),a.panel.isVisible()?a.panel.isVisible()&&e._server_id==o._server_id?a.panel.setVisible(!1):(o=e,a.panel.setTitle(e.title)):(o=e,a.panel.setVisible(!0),a.panel.setTitle(e.title)),r&&r(o)},register:function(e){r=e,e(o)}}}]).controller("fileCtrl",["$scope","$mdDialog","FilePanelService","authService",function(t,l,i,n){var o=function(){var e=FileSystem._objects[t.files._server_id];t.files=e.get_obj(),t.$apply()};i.register(function(e){if(t.files){var l=FileSystem._objects[t.files._server_id];l&&l.unbind(o)}if(e){t.files=e;var i=FileSystem._objects[t.files._server_id];i&&i.bind(o)}}),t.user=n.get_user(),t.deleteFile=function(e){console.log(e);var i=l.confirm().ok("Delete !").title("Do you want to remove it?").cancel("Cancel").clickOutsideToClose(!0);l.show(i).then(function(l){var i=FileSystem._objects[t.files._server_id];if(i)for(var n=0;n<i.files.length;n++)i.files[n]._server_id==e._server_id?i.files.splice(n,1):(console.log(i.files[n]._server_id),console.log(e._server_id));else console.log("mod null")},function(){})},t.downloadFile=function(e){for(var l=FileSystem._objects[t.files._server_id],i=0;i<l.files.length;i++)if(l.files[i]._server_id==e._server_id){selected.load(function(e,t){if(e instanceof Path){var l=document.createElement("a");l.setAttribute("href","/sceen/_?u="+e._server_id),l.setAttribute("download",selected.name),l.style.display="none",document.body.appendChild(l),l.click(),document.body.removeChild(l)}});break}},e.handle_files=function(e){var l,i=FileSystem._objects[t.files._server_id];if(e.target&&i)for(var n=0;n<e.target.files.length;n++){var o=e.target.files[n];l=new Path(o),i.files.force_add_file(o.name,l),t.$apply()}}}])}).call(window,window);

},{}],14:[function(require,module,exports){
"use strict";angular.module("app.services").factory("goldenLayoutService",["$q","$window","$templateCache","$rootScope","$compile",function(e,t,n,o,r){var i={content:[{type:"row",content:[{isClosable:!1,title:"Viewer",type:"component",componentName:"SpinalHome",componentState:{template:"forgeviewer.html",controller:"forgeViewerCtrl"}}]}]},a=0,c={init:function(){0==a&&((a=new GoldenLayout(i,$("#g-layout"))).registerComponent("SpinalHome",function(e,t){var i=e.getElement();""==t.template?(i.html(),r(i.contents())(o)):(i.html('<div class="gpannel-content" ng-controller="'+t.controller+'" ng-cloak>'+n.get(t.template)+"</div>"),r(i.contents())(o))}),a.init(),angular.element(t).bind("resize",function(){a.updateSize()}),o.$emit("GoldenLayout_READY"))},wait_ready:function(){return e(function(e,t){o.$on("GoldenLayout_READY",function(){e()})})},createChild:function(e){a.root.contentItems[0].addChild(e)},createDragSource:function(e,t){a.createDragSource(e,t)}};return c}]).factory("layout_uid",function(){var e=0;return{get:function(){return e++}}}).factory("spinalRegisterViewerPlugin",function(){var e=[];return{get:function(){return e},register:function(t){for(var n=0;n<e.length;n++)if(e[n]===t)return;e.push(t)}}});

},{}],15:[function(require,module,exports){
(function(e){"use strict";angular.module("app.spinalcom").factory("messagePanelFactory",["$rootScope","$compile","$templateCache","$http",function(e,t,s,n){for(var a=this,i=function(e,t){n.get(e).then(function(e){s.put(t,e.data)},function(t){console.log("Cannot load the file "+e)})},l=[{uri:"app/templates/commentTemplate.html",name:"commentTemplate.html"}],r=0;r<l.length;r++)i(l[r].uri,l[r].name);this.panel=new PanelClass(v,"message Panel"),this.panel.container.style.right="0px",this.panel.container.style.width="400px",this.panel.container.style.height="600px",this.panel.container.padding="0px";var o=document.createElement("div");o.style.height="calc(100% - 45px)",o.style.overflowY="auto",this.panel.container.appendChild(o);var c=!1;return{getPanel:function(){return 0==c&&(c=!0,$(o).html('<div ng-controller="commentCtrl" class="panelContent" ng-cloak>'+s.get("commentTemplate.html")+"</div>"),t($(o).contents())(e)),a.panel}}}]).factory("messagePanelService",["$rootScope","$compile","$templateCache","$http","messagePanelFactory",function(e,t,s,n,a){var i,l=this,r=!1,o=null;return{hideShowPanel:function(e){0==r&&(r=!0,l.panel=a.getPanel()),l.panel.isVisible()?l.panel.isVisible()&&e._server_id==i._server_id?l.panel.setVisible(!1):(i=e,l.panel.setTitle(e.title)):(i=e,l.panel.setVisible(!0),l.panel.setTitle(e.title)),o&&o(i)},register:function(e){o=e,e(i)}}}]).controller("commentCtrl",["$scope","messagePanelService","authService",function(e,t,s){var n=function(){var t=FileSystem._objects[e.messages._server_id];e.messages=t.get_obj(),e.$apply()};t.register(function(t){if(e.messages){var s=FileSystem._objects[e.messages._server_id];s&&s.unbind(n)}if(t){e.messages=t;var a=FileSystem._objects[e.messages._server_id];a&&a.bind(n)}}),e.user=s.get_user(),e.messageText="",e.removeMessage=function(t){var s=FileSystem._objects[e.messages._server_id];if(s)for(var n=0;n<s.notes.length;n++)s.notes[n]._server_id==t._server_id&&s.notes.splice(n,1)},e.SendMessage=function(){var t=FileSystem._objects[e.messages._server_id];if(""!=e.messageText&&""!=e.messageText.trim()){var s=new MessageModel;s.owner.set(e.user.id),s.username.set(e.user.username),s.message.set(e.messageText),t&&(t.notes.push(s),e.messageText="")}}}])}).call(window,window);

},{}],16:[function(require,module,exports){
"use strict";angular.module("app.spinalcom").factory("ngSpinalCore",["$q",function(n){var e={conn:0,connect:function(n){e.conn=spinalCore.connect(n)},store:function(o,r){var t=n.defer();return spinalCore.store(e.conn,o,r,function(n){t.resolve(n)},function(){t.reject()}),t.promise},load:function(o){var r=n.defer();return spinalCore.load(e.conn,o,function(n){r.resolve(n)},function(){r.reject()}),r.promise},load_type:function(o,r){var t=n.defer();return spinalCore.load_type(e.conn,o,r,function(n){t.resolve(n)},function(){t.reject()}),t.promise},load_right:function(o){var r=n.defer();return spinalCore.load_right(e.conn,o,function(n){r.resolve(n)},function(){r.reject()}),r.promise},share_model:function(n,o,r,t){return spinalCore.share_model(e.conn,n,o,r,t)}};return e}]);

},{}],17:[function(require,module,exports){
"use strict";angular.module("app.spinalcom").factory("spinalModelDictionary",["$q","ngSpinalCore","config","authService","$routeParams","$location",function(e,o,r,n,t,a){var l={model:0,init:function(){var r=e.defer();return 0==l.model?n.wait_connect().then(function(){n.get_user();var e=t.filepath;console.log(e),e&&(e=atob(e),o.load(e).then(function(e){l.model=e,console.log(e),r.resolve(e)},function(){var o="not able to load : "+e;console.error(o),a.replace("/drive/"),r.reject(o)}))},function(){var e="not able to load : "+path;console.error(e),a.replace("/drive/"),r.reject(e)}):r.resolve(l.model),r.promise}};return l}]);

},{}]},{},[2,1,3,8,16,17,14,12,15,13,6,7,4,5,10,9,11])
//# sourceMappingURL=app.compile.min.js.map
